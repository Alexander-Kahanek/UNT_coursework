) %>%
select(p) %>%
unlist() %>%
as.numeric()
number_of_experiments <- 1 # how many times to draw K samples
number_of_samples <- 100000 # the amount of samples per experiment
multinomial_model_obs <- rmultinom(n = number_of_experiments, size = number_of_samples, prob = probs_seasons)
model_seasons <- multinomial_model_obs %>% # find observations and probabilities of our model
as.data.frame() %>%
rename("obs" = V1) %>%
mutate(
month = 1:n()
,p = obs / number_of_samples
)
chisq.test(model_seasons$obs, p = c(0.249, 0.252, 0.252, 0.247))
# chisq.test(model_seasons$obs, p = c(rep(1/4, 4)))
total_suicides <- 23480 # the total sum of the number of suicides
probs_seasons <- raw %>% # the probability of a suicide being in a month
group_by(season) %>%
summarise(
p = sum(suicides_per_day) / total_spd
) %>%
select(p) %>%
unlist() %>%
as.numeric()
number_of_experiments <- 1 # how many times to draw K samples
number_of_samples <- 100000 # the amount of samples per experiment
multinomial_model_obs <- rmultinom(n = number_of_experiments, size = number_of_samples, prob = probs_seasons)
model_seasons <- multinomial_model_obs %>% # find observations and probabilities of our model
as.data.frame() %>%
rename("obs" = V1) %>%
mutate(
month = 1:n()
,p = obs / number_of_samples
)
chisq.test(model_seasons$obs, p = c(0.249, 0.252, 0.252, 0.247))
# chisq.test(model_seasons$obs, p = c(rep(1/4, 4)))
total_suicides <- 23480 # the total sum of the number of suicides
probs_seasons <- raw %>% # the probability of a suicide being in a month
group_by(season) %>%
summarise(
p = sum(suicides_per_day) / total_spd
) %>%
select(p) %>%
unlist() %>%
as.numeric()
number_of_experiments <- 1 # how many times to draw K samples
number_of_samples <- 100000 # the amount of samples per experiment
multinomial_model_obs <- rmultinom(n = number_of_experiments, size = number_of_samples, prob = probs_seasons)
model_seasons <- multinomial_model_obs %>% # find observations and probabilities of our model
as.data.frame() %>%
rename("obs" = V1) %>%
mutate(
month = 1:n()
,p = obs / number_of_samples
)
chisq.test(model_seasons$obs, p = c(0.249, 0.252, 0.252, 0.247))
# chisq.test(model_seasons$obs, p = c(rep(1/4, 4)))
total_suicides <- 23480 # the total sum of the number of suicides
probs_seasons <- raw %>% # the probability of a suicide being in a month
group_by(season) %>%
summarise(
p = sum(suicides_per_day) / total_spd
) %>%
select(p) %>%
unlist() %>%
as.numeric()
number_of_experiments <- 1 # how many times to draw K samples
number_of_samples <- 100000 # the amount of samples per experiment
multinomial_model_obs <- rmultinom(n = number_of_experiments, size = number_of_samples, prob = probs_seasons)
model_seasons <- multinomial_model_obs %>% # find observations and probabilities of our model
as.data.frame() %>%
rename("obs" = V1) %>%
mutate(
month = 1:n()
,p = obs / number_of_samples
)
chisq.test(model_seasons$obs, p = c(0.249, 0.252, 0.252, 0.247))
# chisq.test(model_seasons$obs, p = c(rep(1/4, 4)))
total_suicides <- 23480 # the total sum of the number of suicides
probs_seasons <- raw %>% # the probability of a suicide being in a month
group_by(season) %>%
summarise(
p = sum(suicides_per_day) / total_spd
) %>%
select(p) %>%
unlist() %>%
as.numeric()
number_of_experiments <- 1 # how many times to draw K samples
number_of_samples <- 100000 # the amount of samples per experiment
multinomial_model_obs <- rmultinom(n = number_of_experiments, size = number_of_samples, prob = probs_seasons)
model_seasons <- multinomial_model_obs %>% # find observations and probabilities of our model
as.data.frame() %>%
rename("obs" = V1) %>%
mutate(
month = 1:n()
,p = obs / number_of_samples
)
chisq.test(model_seasons$obs, p = c(0.249, 0.252, 0.252, 0.247))
# chisq.test(model_seasons$obs, p = c(rep(1/4, 4)))
total_suicides <- 23480 # the total sum of the number of suicides
probs_seasons <- raw %>% # the probability of a suicide being in a month
group_by(season) %>%
summarise(
p = sum(suicides_per_day) / total_spd
) %>%
select(p) %>%
unlist() %>%
as.numeric()
number_of_experiments <- 1 # how many times to draw K samples
number_of_samples <- 100000 # the amount of samples per experiment
multinomial_model_obs <- rmultinom(n = number_of_experiments, size = number_of_samples, prob = probs_seasons)
model_seasons <- multinomial_model_obs %>% # find observations and probabilities of our model
as.data.frame() %>%
rename("obs" = V1) %>%
mutate(
month = 1:n()
,p = obs / number_of_samples
)
chisq.test(model_seasons$obs, p = c(0.249, 0.252, 0.252, 0.247))
# chisq.test(model_seasons$obs, p = c(rep(1/4, 4)))
total_suicides <- 23480 # the total sum of the number of suicides
probs_seasons <- raw %>% # the probability of a suicide being in a month
group_by(season) %>%
summarise(
p = sum(suicides_per_day) / total_spd
) %>%
select(p) %>%
unlist() %>%
as.numeric()
number_of_experiments <- 1 # how many times to draw K samples
number_of_samples <- 100000 # the amount of samples per experiment
multinomial_model_obs <- rmultinom(n = number_of_experiments, size = number_of_samples, prob = probs_seasons)
model_seasons <- multinomial_model_obs %>% # find observations and probabilities of our model
as.data.frame() %>%
rename("obs" = V1) %>%
mutate(
month = 1:n()
,p = obs / number_of_samples
)
chisq.test(model_seasons$obs, p = c(0.249, 0.252, 0.252, 0.247))
# chisq.test(model_seasons$obs, p = c(rep(1/4, 4)))
total_suicides <- 23480 # the total sum of the number of suicides
probs_seasons <- raw %>% # the probability of a suicide being in a month
group_by(season) %>%
summarise(
p = sum(suicides_per_day) / total_spd
) %>%
select(p) %>%
unlist() %>%
as.numeric()
number_of_experiments <- 1 # how many times to draw K samples
number_of_samples <- 100000 # the amount of samples per experiment
multinomial_model_obs <- rmultinom(n = number_of_experiments, size = number_of_samples, prob = probs_seasons)
model_seasons <- multinomial_model_obs %>% # find observations and probabilities of our model
as.data.frame() %>%
rename("obs" = V1) %>%
mutate(
month = 1:n()
,p = obs / number_of_samples
)
chisq.test(model_seasons$obs, p = c(0.249, 0.252, 0.252, 0.247))
# chisq.test(model_seasons$obs, p = c(rep(1/4, 4)))
total_suicides <- 23480 # the total sum of the number of suicides
probs_seasons <- raw %>% # the probability of a suicide being in a month
group_by(season) %>%
summarise(
p = sum(suicides_per_day) / total_spd
) %>%
select(p) %>%
unlist() %>%
as.numeric()
number_of_experiments <- 1 # how many times to draw K samples
number_of_samples <- 100000 # the amount of samples per experiment
multinomial_model_obs <- rmultinom(n = number_of_experiments, size = number_of_samples, prob = probs_seasons)
model_seasons <- multinomial_model_obs %>% # find observations and probabilities of our model
as.data.frame() %>%
rename("obs" = V1) %>%
mutate(
month = 1:n()
,p = obs / number_of_samples
)
chisq.test(model_seasons$obs, p = c(0.249, 0.252, 0.252, 0.247))
# chisq.test(model_seasons$obs, p = c(rep(1/4, 4)))
total_suicides <- 23480 # the total sum of the number of suicides
total_spd <- 772.1843
# probs <- raw %>% # the probability of a suicide being in a month
#   group_by(month) %>%
#   summarise (
#     p = nSuicides / total_suicides
#   ) %>%
#   select(p) %>%
#   unlist() %>%
#   as.numeric()
probs <- raw %>% # the probability of a suicide being in a month
group_by(month) %>%
summarise (
p = sum(suicides_per_day) / total_spd
) %>%
select(p) %>%
unlist() %>%
as.numeric()
number_of_experiments <- 1 # how many times to draw K samples
number_of_samples <- 100000 # the amount of samples per experiment
multinomial_model_obs <- rmultinom(n = number_of_experiments, size = number_of_samples, prob = probs)
model <- multinomial_model_obs %>% # find observations and probabilities of our model
as.data.frame() %>%
rename("obs" = V1) %>%
mutate(
month = 1:n()
,p = obs / number_of_samples
)
chisq.test(model$obs, p = raw$nDays/365)
# chisq.test(model$obs, p = c(rep(1/12, 12)))
total_suicides <- 23480 # the total sum of the number of suicides
total_spd <- 772.1843
# probs <- raw %>% # the probability of a suicide being in a month
#   group_by(month) %>%
#   summarise (
#     p = nSuicides / total_suicides
#   ) %>%
#   select(p) %>%
#   unlist() %>%
#   as.numeric()
probs <- raw %>% # the probability of a suicide being in a month
group_by(month) %>%
summarise (
p = sum(suicides_per_day) / total_spd
) %>%
select(p) %>%
unlist() %>%
as.numeric()
number_of_experiments <- 1 # how many times to draw K samples
number_of_samples <- 100000 # the amount of samples per experiment
multinomial_model_obs <- rmultinom(n = number_of_experiments, size = number_of_samples, prob = probs)
model <- multinomial_model_obs %>% # find observations and probabilities of our model
as.data.frame() %>%
rename("obs" = V1) %>%
mutate(
month = 1:n()
,p = obs / number_of_samples
)
chisq.test(model$obs, p = raw$nDays/365)
# chisq.test(model$obs, p = c(rep(1/12, 12)))
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(cowplot)
total_suicides <- 23480 # the total sum of the number of suicides
total_spd <- 772.1843
# probs <- raw %>% # the probability of a suicide being in a month
#   group_by(month) %>%
#   summarise (
#     p = nSuicides / total_suicides
#   ) %>%
#   select(p) %>%
#   unlist() %>%
#   as.numeric()
probs <- raw %>% # the probability of a suicide being in a month
group_by(month) %>%
summarise (
p = sum(suicides_per_day) / total_spd
) %>%
select(p) %>%
unlist() %>%
as.numeric()
number_of_experiments <- 1 # how many times to draw K samples
number_of_samples <- 100000 # the amount of samples per experiment
multinomial_model_obs <- rmultinom(n = number_of_experiments, size = number_of_samples, prob = probs)
model <- multinomial_model_obs %>% # find observations and probabilities of our model
as.data.frame() %>%
rename("obs" = V1) %>%
mutate(
month = 1:n()
,p = obs / number_of_samples
)
chisq.test(model$obs, p = raw$nDays/365)
# chisq.test(model$obs, p = c(rep(1/12, 12)))
total_suicides <- 23480 # the total sum of the number of suicides
total_spd <- 772.1843
# probs <- raw %>% # the probability of a suicide being in a month
#   group_by(month) %>%
#   summarise (
#     p = nSuicides / total_suicides
#   ) %>%
#   select(p) %>%
#   unlist() %>%
#   as.numeric()
probs <- raw %>% # the probability of a suicide being in a month
group_by(month) %>%
summarise (
p = sum(suicides_per_day) / total_spd
) %>%
select(p) %>%
unlist() %>%
as.numeric()
number_of_experiments <- 1 # how many times to draw K samples
number_of_samples <- 100000 # the amount of samples per experiment
multinomial_model_obs <- rmultinom(n = number_of_experiments, size = number_of_samples, prob = probs)
model <- multinomial_model_obs %>% # find observations and probabilities of our model
as.data.frame() %>%
rename("obs" = V1) %>%
mutate(
month = 1:n()
,p = obs / number_of_samples
)
chisq.test(model$obs, p = raw$nDays/365)
# chisq.test(model$obs, p = c(rep(1/12, 12)))
total_suicides <- 23480 # the total sum of the number of suicides
total_spd <- 772.1843
# probs <- raw %>% # the probability of a suicide being in a month
#   group_by(month) %>%
#   summarise (
#     p = nSuicides / total_suicides
#   ) %>%
#   select(p) %>%
#   unlist() %>%
#   as.numeric()
probs <- raw %>% # the probability of a suicide being in a month
group_by(month) %>%
summarise (
p = sum(suicides_per_day) / total_spd
) %>%
select(p) %>%
unlist() %>%
as.numeric()
number_of_experiments <- 1 # how many times to draw K samples
number_of_samples <- 100000 # the amount of samples per experiment
multinomial_model_obs <- rmultinom(n = number_of_experiments, size = number_of_samples, prob = probs)
model <- multinomial_model_obs %>% # find observations and probabilities of our model
as.data.frame() %>%
rename("obs" = V1) %>%
mutate(
month = 1:n()
,p = obs / number_of_samples
)
chisq.test(model$obs, p = raw$nDays/365)
# chisq.test(model$obs, p = c(rep(1/12, 12)))
total_suicides <- 23480 # the total sum of the number of suicides
total_spd <- 772.1843
# probs <- raw %>% # the probability of a suicide being in a month
#   group_by(month) %>%
#   summarise (
#     p = nSuicides / total_suicides
#   ) %>%
#   select(p) %>%
#   unlist() %>%
#   as.numeric()
probs <- raw %>% # the probability of a suicide being in a month
group_by(month) %>%
summarise (
p = sum(suicides_per_day) / total_spd
) %>%
select(p) %>%
unlist() %>%
as.numeric()
number_of_experiments <- 1 # how many times to draw K samples
number_of_samples <- 100000 # the amount of samples per experiment
multinomial_model_obs <- rmultinom(n = number_of_experiments, size = number_of_samples, prob = probs)
model <- multinomial_model_obs %>% # find observations and probabilities of our model
as.data.frame() %>%
rename("obs" = V1) %>%
mutate(
month = 1:n()
,p = obs / number_of_samples
)
chisq.test(model$obs, p = raw$nDays/365)
# chisq.test(model$obs, p = c(rep(1/12, 12)))
total_suicides <- 23480 # the total sum of the number of suicides
total_spd <- 772.1843
# probs <- raw %>% # the probability of a suicide being in a month
#   group_by(month) %>%
#   summarise (
#     p = nSuicides / total_suicides
#   ) %>%
#   select(p) %>%
#   unlist() %>%
#   as.numeric()
probs <- raw %>% # the probability of a suicide being in a month
group_by(month) %>%
summarise (
p = sum(suicides_per_day) / total_spd
) %>%
select(p) %>%
unlist() %>%
as.numeric()
number_of_experiments <- 1 # how many times to draw K samples
number_of_samples <- 100000 # the amount of samples per experiment
multinomial_model_obs <- rmultinom(n = number_of_experiments, size = number_of_samples, prob = probs)
model <- multinomial_model_obs %>% # find observations and probabilities of our model
as.data.frame() %>%
rename("obs" = V1) %>%
mutate(
month = 1:n()
,p = obs / number_of_samples
)
chisq.test(model$obs, p = raw$nDays/365)
# chisq.test(model$obs, p = c(rep(1/12, 12)))
total_suicides <- 23480 # the total sum of the number of suicides
total_spd <- 772.1843
# probs <- raw %>% # the probability of a suicide being in a month
#   group_by(month) %>%
#   summarise (
#     p = nSuicides / total_suicides
#   ) %>%
#   select(p) %>%
#   unlist() %>%
#   as.numeric()
probs <- raw %>% # the probability of a suicide being in a month
group_by(month) %>%
summarise (
p = sum(suicides_per_day) / total_spd
) %>%
select(p) %>%
unlist() %>%
as.numeric()
number_of_experiments <- 1 # how many times to draw K samples
number_of_samples <- 100000 # the amount of samples per experiment
multinomial_model_obs <- rmultinom(n = number_of_experiments, size = number_of_samples, prob = probs)
model <- multinomial_model_obs %>% # find observations and probabilities of our model
as.data.frame() %>%
rename("obs" = V1) %>%
mutate(
month = 1:n()
,p = obs / number_of_samples
)
chisq.test(model$obs, p = raw$nDays/365)
# chisq.test(model$obs, p = c(rep(1/12, 12)))
total_suicides <- 23480 # the total sum of the number of suicides
total_spd <- 772.1843
# probs <- raw %>% # the probability of a suicide being in a month
#   group_by(month) %>%
#   summarise (
#     p = nSuicides / total_suicides
#   ) %>%
#   select(p) %>%
#   unlist() %>%
#   as.numeric()
probs <- raw %>% # the probability of a suicide being in a month
group_by(month) %>%
summarise (
p = sum(suicides_per_day) / total_spd
) %>%
select(p) %>%
unlist() %>%
as.numeric()
number_of_experiments <- 1 # how many times to draw K samples
number_of_samples <- 100000 # the amount of samples per experiment
multinomial_model_obs <- rmultinom(n = number_of_experiments, size = number_of_samples, prob = probs)
model <- multinomial_model_obs %>% # find observations and probabilities of our model
as.data.frame() %>%
rename("obs" = V1) %>%
mutate(
month = 1:n()
,p = obs / number_of_samples
)
chisq.test(model$obs, p = raw$nDays/365)
# chisq.test(model$obs, p = c(rep(1/12, 12)))
total_suicides <- 23480 # the total sum of the number of suicides
total_spd <- 772.1843
# probs <- raw %>% # the probability of a suicide being in a month
#   group_by(month) %>%
#   summarise (
#     p = nSuicides / total_suicides
#   ) %>%
#   select(p) %>%
#   unlist() %>%
#   as.numeric()
probs <- raw %>% # the probability of a suicide being in a month
group_by(month) %>%
summarise (
p = sum(suicides_per_day) / total_spd
) %>%
select(p) %>%
unlist() %>%
as.numeric()
number_of_experiments <- 1 # how many times to draw K samples
number_of_samples <- 100000 # the amount of samples per experiment
multinomial_model_obs <- rmultinom(n = number_of_experiments, size = number_of_samples, prob = probs)
model <- multinomial_model_obs %>% # find observations and probabilities of our model
as.data.frame() %>%
rename("obs" = V1) %>%
mutate(
month = 1:n()
,p = obs / number_of_samples
)
chisq.test(model$obs, p = raw$nDays/365)
# chisq.test(model$obs, p = c(rep(1/12, 12)))
total_suicides <- 23480 # the total sum of the number of suicides
probs_seasons <- raw %>% # the probability of a suicide being in a month
group_by(season) %>%
summarise(
p = sum(suicides_per_day) / total_spd
) %>%
select(p) %>%
unlist() %>%
as.numeric()
number_of_experiments <- 1 # how many times to draw K samples
number_of_samples <- 100000 # the amount of samples per experiment
multinomial_model_obs <- rmultinom(n = number_of_experiments, size = number_of_samples, prob = probs_seasons)
model_seasons <- multinomial_model_obs %>% # find observations and probabilities of our model
as.data.frame() %>%
rename("obs" = V1) %>%
mutate(
month = 1:n()
,p = obs / number_of_samples
)
# raw %>% group_by(season) %>% summarise(c= sum(nDays)/365) %>% select(c)
chisq.test(model_seasons$obs, p = c(0.249, 0.252, 0.252, 0.247))
# chisq.test(model_seasons$obs, p = c(rep(1/4, 4)))
raw$suicides_per_day %>% mean()
raw$suicides_per_day %>% var()
